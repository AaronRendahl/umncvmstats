---
title: "Setting up R and Rstudio"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Setting up R and Rstudio}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: 72
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
#| include: false
#| message: false
library(conflicted)
library(tidyverse)
library(umncvmstats)
conflicts_prefer(dplyr::select)
```

## Installing R and Rstudio

Download and install both R and Rstudio. See links here:
<https://posit.co/download/rstudio-desktop/>

You need both; "R" is the software underneath that actually does the work; 
"Rstudio" is the interface that makes the doing the work much easier.

For Fall 2024, you should have R version 4.4.1 and Rstudio version 2024.04.2 Build 764.
You can check the version of R by checking the Console pane when you start Rstudio, or
by typing `R.version.string` in the console. You can check the version of Rstudio using Help > About Rstudio, or by by typing `RStudio.Version()$version` in the console.

## Installing packages

R has many add-on packages that allow one to do more specialized tasks or
make every-day tasks easier. We'll be using a set of packages called the
"tidyverse", and a package specifically for this course called "umncvmstats".

To install them, start Rstudio and run these three lines into the console.
Each of these will download and install not only the package, but all
other packages that it depends on it, so it can take a while (minutes, not hours).

The "devtools" installation may give you a warning about "Rtools"; this can be ignored.

```{r}
#| eval: false
install.packages("tidyverse")
install.packages("devtools")
devtools::install_github("AaronRendahl/umncvmstats")
```

You only need to run these lines once, you do not need to run them every time 
you open R.

However, I may ask you to reinstall the `umncvmstats` package during the semester; it's
possible as the class uses it, we'll find things that need to be updated.

### For updated installations only:
If you had a previous version of R that you recently updated to most recent version,
you should also make sure that all your packages are updated, using this code.

If you just did installed R for the first time, this is unnecessary.

```{r}
#| eval: false
update.packages(ask = FALSE, checkBuilt = TRUE)
```

## Setting preferences

There are three important preferences to set.

Under the Tools menu, select Global Options.

- For General (on the left side), and Basic (on the top):

  1. Unselect “Restore .RData into workspace at startup”.

  2. For “Save workspace to .RData on exit” select “Never”.

This preference is important as it prevents R from remembering anything from
session to session. Although that sounds like a good idea, it can make your 
work very difficult to reproduce.

```{r}
#| echo: false
#| fig.alt: Screenshot of the Preferences/General window
#| out.width: "80%"
knitr::include_graphics("preferences1.png")
```

- For "R Markdown" (on the left side),

  3. Unselect "Show output inline for all R Markdown documents".

I suggest you start this way, as that's what I'll demonstrate, but you're welcome
to try inline output and see if you prefer it.

```{r}
#| echo: false
#| fig.alt: Screenshot of the Preferences/R Markdown window
#| out.width: "80%"
knitr::include_graphics("preferences2.png")
```

## File Management

To be able to work with data files and R, you need to be able to be use your
file manager (Finder on Mac) to navigate to files and folders, move and rename files, 
and find files you've downloaded.

Let's set up a folder for you to use for all your R code and assignments in this class,
and practice downloading files and moving them to this folder.

1. Decide where you want your files for this class to be and use your file manager
to create a new folder there. Computers sometimes have issues with spaces in filenames,
so I recommend using only letters, numbers, and underscores for the name of this folder. For example, "VMED5915_Fall2024".

2. Download the following file and move it in this folder. 
On most systems it will default to saving in a "Downloads" folder; find the file
there and move it to the folder you just created.
You may also be able to use "Save File As" to save it there directly.

http://www.stat.umn.edu/~rend0020/data/books1.csv

3. You also may need to download files from Google Drive. That can be a little different, so let's try that too. Go to this Google Drive folder and download the `books.xlsx` file, and move it to your class folder.

https://drive.google.com/drive/folders/1EViFHfhuxpKpte4IQXHoG_Ck_RgUC_rx?usp=drive_link


Note that I'm having you put all your files in the main folder; if want to use subfolders, ask about the "here" package, which helps your files to be found no matter how your files are arranged.

## Creating a Project

Now that you have a folder for this class, you need to tell Rstudio that that folder is the one you want to use for everything. In Rstudio, this folder will be called a "project". Using a project really helps with reproducibility, and helps Rstudio find the files it needs to work properly (though it can have trouble with subfolders, so if you want to use subfolders, ask about the `here` package).

* Open Rstudio and go to File > New Project. Then select "Existing Directory" and choose the folder you created for this class.

This will create a new file ending in `Rproj` in the folder you created and open Rstudio in that project folder. Check to make sure it's in the desired project by looking at the upper right corner of Rstudio, it should say the name of your folder there.

In the lower right pane you should also see a list of the files in this folder, which should include the Rproj file that Rstudio just created, along with the files you downloaded earlier.

## Starting R

It's important that every time you start Rstudio to work on things for this class that you open this project file. There's (at least) two ways to do that; you can either use your file manager to find the folder you created and open the Rproj file; assuming your installation worked properly, that should open R within that project. Alternatively, you can use the File > Open Project or File > Recent Projects menus. These can also be found in the upper right where the current project name is shown.

* Try closing Rstudio and reopening it in the project for this class. Check the upper right corner and the files pane to make sure it's open properly.

I recommend one of those methods for opening a project, especially when one has multiple projects. However, if you want to always open in this specific project, use the preference in Tools > Global Options > General > Basic to set the "Restore most recently opened project at setup" option.
