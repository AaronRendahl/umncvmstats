---
title: "Statistical Tests"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Statistical Tests}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(umncvmstats)

```

## Tests for Proportions

### One Proportion Test
```{r}
one_proportion_test(vs~1, data=mtcars2)
```

#### Separately by another categorical variable
```{r}
one_proportion_test(vs ~ am, data=mtcars2)
```

### Two Proportion Test
```{r}
two_proportion_test(vs ~ am, data=mtcars2)
```

#### together in one table
```{r}
combine_tests(
  one_proportion_test(vs ~ am, data=mtcars2),
  two_proportion_test(vs ~ am, data=mtcars2))
```

### Pairwise Proportion Tests
```{r}
combine_tests(
  one_proportion_test(vs ~ cyl, data=mtcars2),
  pairwise_proportion_test(vs ~ cyl, data=mtcars2))
```

### Paired Proportion Test (McNemar's)
```{r}
combine_tests(
  one_proportion_test(pass1 + pass2 ~ 1, data=passfail),
  one_proportion_test(pass2 ~ pass1, data=passfail, all_success = TRUE),
  paired_proportion_test(pass2 - pass1 ~ 1, data=passfail))
```

### Independence Test
```{r}
combine_tests(
  one_proportion_test(cyl ~ vs, data=mtcars2, all_success = TRUE),
  independence_test(cyl ~ vs, data=mtcars2))
```

## Tests for Means

### One Sample t-test
```{r}
one_t_test(wt~1, data=mtcars2)
```

#### Separately by another categorical variable
```{r}
one_t_test(wt ~ am, data=mtcars2)
```

### Two Sample t-test
```{r}
two_t_test(wt ~ am, data=mtcars2)
```

#### together in one table
```{r}
combine_tests(
  one_t_test(wt ~ am, data=mtcars2),
  two_t_test(wt ~ am, data=mtcars2))
```

### Pairwise t-tests
```{r}
combine_tests(
  one_t_test(wt ~ cyl, data=mtcars2),
  pairwise_t_test(wt ~ cyl, data=mtcars2))
```

### Paired t-test
```{r}
combine_tests(
  one_t_test(score1 + score2 ~ 1, data=passfail),
  paired_t_test(score2 - score1 ~ 1, data=passfail))
```

## Correlation tests
```{r}
correlation_test(mpg ~ wt + hp, data=mtcars2)
```

## Linear models

### ANOVA

First make the model
```{r}
m1 <- lm(wt ~ cyl, data=mtcars2)
```

ANOVA table:
```{r}
model_anova(m1)
```

model summary values:
```{r}
model_glance(m1)
```

model coefficients:
```{r}
model_coefs(m1)
```

model means:
```{r}
model_means(m1, ~cyl)
```

Comparing model means:
```{r}
pairwise_model_means(m1, ~cyl)
```

### Regression

First make the model
```{r}
m2 <- lm(mpg ~ wt, data=mtcars2)
```

ANOVA table:
```{r}
model_anova(m2)
```

model summary values:
```{r}
model_glance(m2)
```

model coefficients:
```{r}
model_coefs(m2) |> as_gt() |> fmt_numbers(n_sigfig = 3)
```

model slope:
```{r}
model_slopes(m2, wt~1)
```

### Two-way ANOVA
First make the model
```{r}
m3 <- lm(wt ~ vs*am, data=mtcars2)
```

ANOVA table:
```{r}
model_anova(m3)
```

model summary values:
```{r}
model_glance(m3)
```

model coefficients:
```{r}
model_coefs(m3) |> as_gt() |> fmt_numbers(decimals=2)
```

model means, both averaging over other variables, and separately:
```{r}
model_means(m3, ~vs)
```

```{r}
model_means(m3, ~vs|am)
```

Comparing model means, both averaging over other variables, and separately:
```{r}
pairwise_model_means(m3, ~vs)
```

```{r}
pairwise_model_means(m3, ~vs|am)
```

### Multiple regression
First make the model
```{r}
m4 <- lm(mpg ~ am*wt, data=mtcars2)
```

ANOVA table:
```{r}
model_anova(m4) 
```

model summary values:
```{r}
model_glance(m4)
```

model coefficients:
```{r}
model_coefs(m4) |> as_gt() |> fmt_numbers(decimals=2)
```

model means, both averaging over other variables, and separately:
```{r}
model_means(m4, ~am)
```

```{r}
model_means(m4, ~am | wt, at=list(wt=c(2,5)))
```

Comparing model means, both averaging over other variables, and separately:
```{r}
pairwise_model_means(m4, ~am)
```

```{r}
pairwise_model_means(m4, ~am | wt, at=list(wt=c(2,5)))
```

Model slopes, both averaging over other variables, and separately:
```{r}
model_slopes(m4, wt~1)
model_slopes(m4, wt~am)
```

Comparing model slopes

```{r}
pairwise_model_slopes(m4, wt~am)
```
