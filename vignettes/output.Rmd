---
title: "Controlling Output"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Controlling Output}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
#| include: false
library(tibble)
library(gt)
library(umncvmstats)
```

```{r}
a <- combine_tests(
  one_proportion_test(34, 99),
  one_proportion_test(25, 99),
  one_proportion_test(10, 99),
  two_proportion_test(c(25, 34), c(99,99)),
  two_proportion_test(c(10, 34), c(99,99)))
```

## About output from this package

All output from statistical tests in this package are stored as a special object (an `atest`) that knows how to print itself in a nice way.

```{r}
a
```

It does this by converting it into a `gt` object from the [gt](https://gt.rstudio.com/) package.

You can use any `gt` function by first doing this conversion yourself using `as_gt`. If you use any `gt` functions you'll need to load the `gt` library before `umncvmstats`.

The following table looks the same because I haven't added any other functions yet.

```{r}
a |> as_gt()
```

There are also a few useful functions in this package, as follows.

### Rounding

The `fmt_numbers` function will format any numbers (except for integers and p-values), with either a fixed number of decimal places or significant figures.

```{r}
a |> as_gt() |> fmt_numbers(decimals=3)
a |> as_gt() |> fmt_numbers(n_sigfig=3)
```

The `fmt_pvalue` function formats p-values (anything named `p.value` or `p.adjust`), with `digits` significant digits, up to `max.digits` decimals. The default is 2 significant digits, and 4 maximum digits.
```{r}
a |> as_gt() |> fmt_pvalue(digits=3, max.digits=5)
```

### Compacting Tables

This compact table uses `font.size = 13` and `spacing = 1`.
```{r}
a |> as_gt() |> tab_compact()
```

```{r}
a |> as_gt() |> tab_compact(font.size = 11, spacing = 3)
```

### Text Output

To not use the `gt` style output, `print` with `as_gt=FALSE`.

```{r}
a |> print(as_gt=FALSE)
```

### Raw Table

To get the raw table, use `as_tibble`. You'll need to have loaded the `tibble` library, which loads as part of the `tidyverse`. There are several options for how to handle the footnotes.

```{r}
a |> as_tibble()
```
